
<html>
<style>
*{margin:0;}
tbody{  margin:5px;}
button { border: none; color: white; padding: 14px 28px;
font-size: 20px; cursor: pointer; text-align: center; }
#demo, #demo1{  font-weight: -300; font-family: fantasy; 
display: flex; flex-wrap: wrap; justify-content: center; }
td{ width: 180px; height: 200px;text-align:center; cursor:pointer; font-size:100px; }
.th1{color:white;background-image: url("https://cdn.edu.buncee.com/assets/f65d5bd3b2428f1f6ace7a0ce37fb30a/sticker-education-steam-0003-vector-smart-object.png");background-repeat: no-repeat, repeat;background-size: 180px 200px;}
.th2{color:#0e0401;background-image: url("https://cdn.edu.buncee.com/assets/bbd34db8c2175fcf5920dcf2a3e2f989/sticker-education-postit-042120-5.png");background-repeat: no-repeat, repeat;background-size: 180px 200px;}
</style>

<body>
<button onclick="ekle()" id="ekle" style="background-color: #04AA6D; width: 80%;">Yeni Siparis ekle</button><button id="gerial" onclick="gerial()" style="background-color: red; width: 20%;">Ayar</button>
<table id="demo"></table>
<table id="demo1"></table>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
  const firebaseConfig = { databaseURL: "https://myapp-150186-default-rtdb.europe-west1.firebasedatabase.app", };
  const app = initializeApp(firebaseConfig);
    
  import { getDatabase, ref, onChildAdded, onChildChanged,
            onChildRemoved, query, limitToFirst, limitToLast, 
            set, remove, onValue, child, get, update } 
  from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js"
    
  const db = getDatabase();
  const commentsRef = ref(db);

  onValue(query(ref(db),), (snapshot) => {  
  demo.innerHTML = null; 
  demo1.innerHTML = null; 
  
  snapshot.forEach((childSnapshot) => { 

if (childSnapshot.val().hal == "1"){ 
demo.innerHTML += `<td id="${childSnapshot.val().keyz}" class="th1">${childSnapshot.val().sira}</td>`;
const sik = childSnapshot.val().sira;
alertFunc(sik);

}else{
demo.innerHTML += `<td hidden id="${childSnapshot.val().keyz}" class="th2">${childSnapshot.val().sira}</td>`;
demo1.innerHTML += `<td id="${childSnapshot.val().keyz}" class="th2">${childSnapshot.val().sira}</td>`;
}
})

function alertFunc(sik) {

const x = new Audio("https://www.myinstants.com/media/sounds/boxing-bell-sound-effect-with-download-link.mp3" );
x.play(); x.volume = 1;

speak(sik);
}

function speak(sik){
setTimeout(() => {
  const text = `KÃ¸lapp nummer ${sik}`;
  const utterance = new SpeechSynthesisUtterance(text);
  window.speechSynthesis.speak(utterance);
}, 1500);
}
onclick = () =>{

if (event.target.className == "th2"){
update(ref(db, event.target.id), {sira:event.target.innerHTML , hal:1, keyz:event.target.id});
}

if (event.target.className == "th1"){
remove(ref(db, event.target.id));
}

if (event.target.id == "ekle"){

const kid = new Date().toISOString().slice("2", "22").replaceAll(":","").replaceAll(".","").replaceAll("-","").replaceAll("T","");

if (snapshot.size == 0){ set(ref(db,kid), {sira:1, hal:2, keyz:kid}) 
}else{
const len = eval(Number(demo.rows[demo.rows.length-1].cells[0].innerText)+1);
set(ref(db,kid), {sira:len, hal:2, keyz:kid}) 
	}
}

if (event.target.id == "gerial"){
const kid = new Date().toISOString().slice("2", "22").replaceAll(":","").replaceAll(".","").replaceAll("-","").replaceAll("T","");
const mainMenu = [ "Bitenler icin 2","Mutfakda olan icin 1"];

let coment = prompt("Hangi Numara geri alinacak?", "");
let no = prompt(`Siparis durumu nedir? \n${mainMenu.join('\n')}`, "2");
if (coment == "" || coment.length> 2 || no.length> 1 || !no.includes("1") && !no.includes("2")) {
alert("YANLIS OLDU, BASTAN YAP!");
} else {
  set(ref(db,kid), {sira:coment, hal:Number(no), keyz:kid}) 
	}
}

}   // IF BURDA BITIYOR..

});   // KABSUL BURDA BITIYOR..

</script>

</body>
</html>
